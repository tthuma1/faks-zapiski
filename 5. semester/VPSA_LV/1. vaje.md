- SLURM - nabor servisov za uporabljanje gruče (https://slurm.schedmd.com/documentation.html)
- `srun hostname`
- glavno vozlišče vse koordinira - mi niti nimamo dostopa do njega
- porazdeljen datotečni sistem - vsi računalniki v gruči vidijo isti datotečni sistem, iste podatke

```
sinfo --long --Node # izpiše vse informacije o računskih vozliščih v sistemu (ne vidimo podatkovnih vozlišč in glavnega vozlišča)
```
```
NODELIST   NODES    PARTITION       STATE CPUS    S:C:T MEMORY TMP_DISK WEIGHT AVAIL_FE REASON              

gwn01          1          gpu       mixed 64     2:16:2 256000        0      1 amd,geno none                

gwn02          1          gpu   allocated 64     2:16:2 256000        0      1 amd,geno none                

gwn03          1          gpu       mixed 64     2:16:2 256000        0      1 amd,geno none                

gwn04          1          gpu   allocated 64     2:16:2 256000        0      1 amd,geno none                

gwn05          1          gpu       mixed 64     2:16:2 256000        0      1 amd,geno none                

gwn06          1          gpu       mixed 64     2:16:2 256000        0      1 amd,geno none                

gwn07          1  mig-preempt        idle 64     2:16:2 256000        0      1 amd,geno none                

gwn07          1 mig-priority        idle 64     2:16:2 256000        0      1 amd,geno none                

gwn08          1          gpu       mixed 96     2:24:2 512000        0      1 amd,geno none                

gwn09          1          gpu       mixed 96     2:24:2 512000        0      1 amd,geno none                

gwn10          1          gpu       mixed 96     2:24:2 512000        0      1 amd,geno none                

wn012          1         all*   allocated 16      1:8:2 336000        0      1 amd,rome none                

wn013          1         all*   allocated 16      1:8:2 336000        0      1 amd,rome none                

wn014          1         all*   allocated 16      1:8:2 336000        0      1 amd,rome none                

wn015          1         all*   allocated 16      1:8:2 320000        0      1 amd,rome none                

wn016          1         all*   allocated 16      1:8:2 336000        0      1 amd,rome none
...
```
- nam so na voljo particije gpu, long in all
- računska vozlišča so ločene v skupine (particije), glede na to, čemu so namenjena tista vozlišča:
	- gpu - imajo grafične kartice, za ML
	- all* pomeni, da je to privzeta particija
	- long - za programe, ki se bodo izvajali dolgo časa (več dni, tednov)
- state:
	- name pove, kaj ostali delajo gor
	- allocated = zaseden
	- mixed = delno zaseden
	- idle = nezaseden
	- drained = spraznjeno
- CPUs:
	- pove število jeder
	- S:C:T: sockets, cores, threads
- reason:
	- razlog, če vozlišče ni dostopno

Izpis poslov:
```
squeue
squeue --me
```
- posel = program, ki ga želimo pognati + viri, ki jih rabimo za poganjanje programa (CPU, RAM, čas)

- programov ne želimo izvajati na vstopnem vozlišču:
	- `hostname` - to ni OK
	- program želimo poganjati na računskih vozliščih
	- `srun hostname` - OK - ustvari nov posel, ki se preda nadzorniku (SLURM-u), ki poišče vire
	- rezervacija za naš predmet:
		- omejeno je, da lahko samo mi izvajamo programe gor, zato bo mogoče manj zasedeno
		- `srun --reservation=fri hostname` - vedno bomo dobili isti rezultat, ker je samo ta strežnik v rezervaciji; ima posebej čakalno vrsto
		- `srun --ntasks=4 hostname` - zahtevam 4 procesorska jedra in na vsakem se bo zagnala ena instanca programa, ki smo ga napisali
		- privzeto dobimo 1 jedro, 2 GB RAM in 30 min časa => ugotovimo z `scontrol show partition`
		- največ dva dni se lahko nekaj izvaja na `all` particiji; na `long` particiji je omejitev 14 dni
		- ![500](../../Images4/Pasted%20image%2020251013181722.png)

- `srun --time=01:0:00 --mem-per-cpu=4GB hostname`
- neinteraktivno poganjanje:
```sh
#!/bin/bash
#SBATCH --job-name=my_job_name
#SBATCH --partition=all
#SBATCH --reservation=fri
#SBATCH --ntasks=4
#SBATCH --nodes=1
#SBATCH --mem-per-cpu=100MB
#SBATCH --output=my_job.out
#SBATCH --time=00:01:00

srun hostname
```
- vse isto kot prej, samo da smo dali parametre v komentarje
- `nodes` = koliko vozlišč bomo uporabili
- `output` = shrani tekstovni rezultat programa (kot če bi STDIN preusmeril)
- `sbatch testni_posel.sh`
- prekinitev posla:
	- spremeni `srun hostname` v `srun sleep 45`
	- `scancel <JOBID>`
	- `scancel --me` - povije vse tvoje posle